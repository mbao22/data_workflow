name: Python Tests

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: [3.8, 3.9, 3.10]

    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v3
      with:
        python-version: ${{ matrix.python-version }}
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    
    - name: Run basic syntax check
      run: |
        python -m py_compile app.py
        python -m py_compile run.py
    
    - name: Create sample data files for testing
      run: |
        echo "customer_id,name,dob,province,city,email,address" > "customer data.txt"
        echo "1,Test User,1990-01-01,Beijing,Beijing,test@example.com,Test Address" >> "customer data.txt"
        
        echo "order_id,customer_id,order_date,product,quantity,amount,status" > "order data.txt"
        echo "1,1,2024-01-01,Test Product,1,100.00,completed" >> "order data.txt"
    
    - name: Test data loading
      run: |
        python -c "
import pandas as pd
import tempfile
import os

# Test customer data loading
try:
    df = pd.read_csv('customer data.txt')
    print('✅ Customer data loaded successfully')
    print(f'Columns: {list(df.columns)}')
except Exception as e:
    print(f'❌ Customer data loading failed: {e}')

# Test order data loading
try:
    df = pd.read_csv('order data.txt')
    print('✅ Order data loaded successfully')
    print(f'Columns: {list(df.columns)}')
except Exception as e:
    print(f'❌ Order data loading failed: {e}')
        "